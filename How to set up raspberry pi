sudo apt update

sudo apt full-upgrade

sudo raspi-config
#select boot/autologin desktop

#make sure sh files are in the right directory

sudo chmod +x /home/tyler/django_server_run.sh
sudo chmod +x /home/tyler/run_kiosk.sh

cd Downloads

git clone https://github.com/Iisyourdad/raspberrypi_recipe.git


cd raspberrypi_recipe
sudo apt update
sudo apt install python3-venv

python3 -m venv venv

source venv/bin/activate

pip install asgiref, Django, django-ckeditor, django-crispy-forms, django-js-asset, pillow, sqlparse, tzdata, gunicorn
pip install asgiref
pip install Django
pip install django-ckeditor
pip install django-crispy-forms
pip install django-js-asset
pip install pillow
pip install sqlparse
pip install tzdata

deactivate

cd ..

sudo d +x /home/tyler/django_server_run.sh
sudo chmod +x /home/tyler/run_kiosk.sh

sudo nano /etc/systemd/system/django.service
"""

[Unit]
Description=Django Server
After=network.target

[Service]
User=tyler
ExecStart=/home/tyler/django_server_run.sh
Restart=always

[Install]
WantedBy=multi-user.target

"""
mkdir -p /home/tyler/.config/systemd/user
nano /home/tyler/.config/systemd/user/kiosk.service

"""
[Unit]
Description=Kiosk Service
After=graphical-session.target

[Service]
ExecStart=/bin/bash /home/tyler/run_kiosk.sh
Restart=on-failure

[Install]
WantedBy=default.target

"""
systemctl --user daemon-reload
systemctl --user enable kiosk.service
systemctl --user start kiosk.service

sudo loginctl enable-linger tyler


sudo systemctl daemon-reload
sudo systemctl enable django.service
sudo systemctl enable kiosk.service
sudo systemctl start django.service
sudo systemctl start kiosk.service

sudo cp /boot/config.txt /boot/config.txt.backup
sudo nano /boot/config.txt

#Put in disable_splash=1

sudo cp /boot/cmdline.txt /boot/cmdline.txt.backup
sudo nano /boot/cmdline.txt

#add quiet splash

sudo systemctl disable getty@tty1.service

sudo nano /usr/local/bin/update_wifi.sh

"""

#!/bin/bash
# This script receives one argument: the configuration text to append.
CONFIG="$1"
# Append the new network configuration.
echo "$CONFIG" >> /etc/wpa_supplicant/wpa_supplicant.conf
# Reconfigure WiFi on wlan0.
sudo /usr/sbin/wpa_cli -i wlan0 reconfigure

"""

sudo chmod +x /usr/local/bin/update_wifi.sh

sudo visudo

tyler ALL=(root) NOPASSWD: /usr/local/bin/update_wifi.sh


